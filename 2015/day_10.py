with open("2015/data/day_10.txt") as f:
    s = f.read().strip()

# https://en.wikipedia.org/wiki/Look-and-say_sequence#Cosmological_decay
decays = {
    "22": ["22"],
    "13112221133211322112211213322112": ["11132", "13", "22", "12", "312211322212221121123222112"],
    "312211322212221121123222112": ["13112221133211322112211213322112"],
    "111312211312113221133211322112211213322112": ["31131122211311122113222", "12", "312211322212221121123222112"],
    "1321132122211322212221121123222112": ["111312211312113221133211322112211213322112"],
    "3113112211322112211213322112": ["1321132122211322212221121123222112"],
    "111312212221121123222112": ["3113112211322112211213322112"],
    "132112211213322112": ["111312212221121123222112"],
    "31121123222112": ["132112211213322112"],
    "111213322112": ["31121123222112"],
    "123222112": ["111213322112"],
    "3113322112": ["132", "123222112"],
    "1113222112": ["3113322112"],
    "1322112": ["1113222112"],
    "311311222112": ["1321132", "1322112"],
    "1113122112": ["311311222112"],
    "132112": ["1113122112"],
    "3112": ["132112"],
    "1112": ["3112"],
    "12": ["1112"],
    "3113112221133112": ["1321132", "13", "22", "12", "32112"],
    "11131221131112": ["3113112221133112"],
    "13211312": ["11131221131112"],
    "31132": ["13211312"],
    "111311222112": ["31132", "1322112"],
    "13122112": ["111311222112"],
    "32112": ["13122112"],
    "11133112": ["312", "32112"],
    "131112": ["11133112"],
    "312": ["131112"],
    "13221133122211332": ["1113222", "12", "3113", "22", "12", "312"],
    "31131122211311122113222": ["1321132", "13221133122211332"],
    "11131221131211322113322112": ["31131122211311122113222", "123222112"],
    "13211321222113222112": ["11131221131211322113322112"],
    "3113112211322112": ["13211321222113222112"],
    "11131221222112": ["3113112211322112"],
    "1321122112": ["11131221222112"],
    "3112112": ["1321122112"],
    "1112133": ["3112112", "3"],
    "12322211331222113112211": ["1112133", "22", "12", "311322113212221"],
    "1113122113322113111221131221": ["311311222", "12322211331222113112211"],
    "13211322211312113211": ["1113122113322113111221131221"],
    "311322113212221": ["13211322211312113211"],
    "132211331222113112211": ["1113222", "12", "311322113212221"],
    "311311222113111221131221": ["1321132", "132211331222113112211"],
    "111312211312113211": ["311311222113111221131221"],
    "132113212221": ["111312211312113211"],
    "3113112211": ["132113212221"],
    "11131221": ["3113112211"],
    "13211": ["11131221"],
    "3112221": ["132", "13211"],
    "1322113312211": ["1113222", "12", "3112221"],
    "311311222113111221": ["1321132", "1322113312211"],
    "11131221131211": ["311311222113111221"],
    "13211321": ["11131221131211"],
    "311311": ["13211321"],
    "11131": ["311311"],
    "1321133112": ["11131", "22", "12", "32112"],
    "31131112": ["1321133112"],
    "111312": ["31131112"],
    "132": ["111312"],
    "311332": ["132", "12", "312"],
    "1113222": ["311332"],
    "13221133112": ["1113222", "12", "32112"],
    "3113112221131112": ["1321132", "13221133112"],
    "111312211312": ["3113112221131112"],
    "1321132": ["111312211312"],
    "311311222": ["1321132", "132"],
    "11131221133112": ["311311222", "12", "32112"],
    "1321131112": ["11131221133112"],
    "311312": ["1321131112"],
    "11132": ["311312"],
    "13112221133211322112211213322113": ["11132", "13", "22", "12", "312211322212221121123222113"],
    "312211322212221121123222113": ["13112221133211322112211213322113"],
    "111312211312113221133211322112211213322113": ["31131122211311122113222", "12", "312211322212221121123222113"],
    "1321132122211322212221121123222113": ["111312211312113221133211322112211213322113"],
    "3113112211322112211213322113": ["1321132122211322212221121123222113"],
    "111312212221121123222113": ["3113112211322112211213322113"],
    "132112211213322113": ["111312212221121123222113"],
    "31121123222113": ["132112211213322113"],
    "111213322113": ["31121123222113"],
    "123222113": ["111213322113"],
    "3113322113": ["132", "123222113"],
    "1113222113": ["3113322113"],
    "1322113": ["1113222113"],
    "311311222113": ["1321132", "1322113"],
    "1113122113": ["311311222113"],
    "132113": ["1113122113"],
    "3113": ["132113"],
    "1113": ["3113"],
    "13": ["1113"],
    "3": ["13"],
}


def lns_len(s, k):
    counter = {s: 1}
    for _ in range(k):
        new_counter = dict()
        for atom, cnt in counter.items():
            for decay in decays[atom]:
                if decay not in new_counter:
                    new_counter[decay] = 0
                new_counter[decay] += cnt
        counter = new_counter
    return sum(cnt * len(atom) for atom, cnt in counter.items())


def part1():
    return lns_len(s, 40)


def part2():
    return lns_len(s, 50)


if __name__ == "__main__":
    print(f"Part 1: {part1()}")
    print(f"Part 2: {part2()}")
